!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Calendula=t()}(this,function(){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e){return"string"==typeof e}function h(e){return"number"==typeof e}function c(e){return void 0===e}function f(e){var t={top:0,left:0};return e&&!c(e.getBoundingClientRect)&&(t=e.getBoundingClientRect()),{top:t.top+(window.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:t.left+(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}}function m(e,t){var n=t.left,i=t.top;e.style.left=h(n)?n+"px":n,e.style.top=h(i)?i+"px":i}function y(e,t){e.style.transform="translateY("+(h(t)?t+"px":t)+")"}var v=[["left","bottom"],["left","top"],["right","bottom"],["right","top"],["center","bottom"],["center","top"]];function p(e,t,n,i){return t<=n||i<=e?0:Math.min(t,i)-Math.max(e,n)}function _(e,t){var n={x1:e.left,y1:e.top,x2:e.left+t.offsetWidth,y2:e.top+t.offsetHeight},i=function(){var e=document.documentElement,t=window.pageXOffset,n=window.pageYOffset;return{x1:t,y1:n,x2:t+e.clientWidth,y2:n+e.clientHeight}}();return p(n.x1,n.x2,i.x1,i.x2)*p(n.y1,n.y2,i.y1,i.y2)}function g(e){return"auto"===e||c(e)}function b(e,t,n){var i=f(n),o=i.left,a=i.top;if(u(e.left))switch(e.left){case"center":o+=(n.offsetWidth-t.offsetWidth)/2;break;case"right":o+=n.offsetWidth-t.offsetWidth}if(u(e.top))switch(e.top){case"top":a-=t.offsetHeight;break;case"center":a-=(t.offsetHeight-n.offsetHeight)/2;break;case"bottom":a+=n.offsetHeight}return{left:o,top:a}}function k(e){return(e<10?"0":"")+e}function M(e,t,n){return[e,k(t+1),k(n)].join("-")}function w(e){var t,n,i=null;if(e)if(u(e)){if("today"===e)return new Date;(t=/^\s*(\d{4})[-/.](\d\d)(?:[-/.](\d\d))?\s*$/.exec(e))?n=[t[3],t[2],t[1]]:(t=/^\s*(\d{1,2})[-/.](\d{1,2})(?:[-/.](\d{4}|\d\d))?\s*$/.exec(e))&&(n=[t[1],t[2],t[3]]),n&&(i=new Date(parseInt(n[2],10),parseInt(n[1]-1,10),parseInt(n[0],10)))}else!function(e){return"object"===o(e)}(e)?h(e)&&(i=new Date(e)):e instanceof Date?i=e:e.year&&e.day&&(i=new Date(e.year,e.month,e.day,12,0,0,0));return i}function E(e){var t=w(e);return t?[t.getFullYear(),k(t.getMonth()+1),k(t.getDate())].join("-"):null}function x(e){var t=w(e);return t?{day:t.getDate(),month:t.getMonth(),year:t.getFullYear()}:{}}function D(){var e=new Date;return{day:e.getDate(),month:e.getMonth(),year:e.getFullYear()}}var S=27,O=34,A=33,C=function(){function e(){a(this,e),this._events={}}return t(e,[{key:"on",value:function(e,t){return e&&t&&(this._events[e]=this._events[e]||[],this._events[e].push({type:e,callback:t})),this}},{key:"off",value:function(e,t){return this._events[e]&&(this._events[e]=this._events[e].filter(function(e){return t!==e.callback})),this}},{key:"trigger",value:function(t,n){var i=this;return this._events[t]&&this._events[t].forEach(function(e){t===e.type&&e.callback.call(i,{type:t},n)}),this}}]),e}();function N(e,t,n,i){return e+(t?"__"+t:"")+(n?"_"+n+(""===i?"":"_"+i):"")}var e=function(){function e(){return a(this,e),l(this,r(e).apply(this,arguments))}return n(e,C),t(e,[{key:"e",value:function(e,t,n){return null===n||!1===n?t="":!0!==n&&void 0!==n||(n=""),N(this._name,e,t,n)}},{key:"m",value:function(e,t){return null===t||!1===t?e="":!0!==t&&void 0!==t||(t=""),N(this._name,"",e,t)}},{key:"delMod",value:function(t,e){var n=this.getElemName(t),i=n?this.e(n,e):this.m(e);return(t.className||"").split(" ").forEach(function(e){e!==i&&-1===e.search(i+"_")||t.classList.remove(e)}),this}},{key:"setMod",value:function(e,t,n){var i=this.getElemName(e);return this.delMod(e,t),e.classList.add(i?this.e(i,t,n):this.m(t,n)),this}},{key:"hasMod",value:function(e,t,n){var i=this.getElemName(e);return e.classList.contains(i?this.e(i,t,n):this.m(t,n))}},{key:"hasElem",value:function(e,t){return e.classList.contains(this.e(t))}},{key:"getElemName",value:function(e){var t=e.className.match(/__([^ _$]+)/);return t?t[1]:""}},{key:"findElem",value:function(e,t,n){return this._dom.querySelector("."+this.e(e,t,n))}},{key:"findElemContext",value:function(e,t,n,i){return e.querySelector("."+this.e(t,n,i))}},{key:"findElemAll",value:function(e,t,n){return this._dom.querySelectorAll("."+this.e(e,t,n))}},{key:"findElemAllContext",value:function(e,t,n,i){return e.querySelectorAll("."+this.e(t,n,i))}}]),e}(),H=function(){function o(e){var t;a(this,o),t=l(this,r(o).call(this,e));var n=o.extend({},e||{}),i=t._prepareYears(n.years);return t.params=o.extend(n,{autocloseable:!!c(n.autocloseable)||n.autocloseable,closeAfterSelection:!!c(n.closeAfterSelection)||n.closeAfterSelection,locale:n.locale||"en",max:x(n.max),min:x(n.min),maxColor:n.maxColor||5,showOn:n.showOn||"click",theme:n.theme||"default",startYear:i.start,endYear:i.end}),t._name="calendula",t._initExtensions(),t.val(t.setting("value")),t._addSwitcherEvents(t.setting("showOn")),t}return n(o,e),t(o,[{key:"isOpened",value:function(){return this._isOpened}},{key:"open",value:function(){var e=this;return this._init(),this.isOpened()||(this.timeout.clearAll(["open","close"]).set(function(){e.setMod(e._dom,"opened",!0),e._update(),e._monthSelector(e._currentDate.month,!1),e._yearSelector(e._currentDate.year,!1),e._openedEvents()},0,"open"),this._isOpened=!0,this.trigger("open")),this}},{key:"close",value:function(){var e=this;return this._init(),this.isOpened()&&(this.timeout.clearAll(["open","close"]).set(function(){e.timeout.clearAll("open"),e._update(),e._delOpenedEvents(),e.delMod(e._dom,"opened"),e.tooltip.hide(),e.trigger("close")},0,"close"),this._isOpened=!1),this}},{key:"toggle",value:function(){return this.isOpened()?this.close():this.open()}},{key:"val",value:function(e){if(!arguments.length)return this._val;e?(this._val=x(e),this._currentDate=o.extend({},this._val)):(this._val={},this._currentDate=D()),this._dom&&this._updateSelection(),this._updateSwitcher()}},{key:"setting",value:function(e,t){var n=this._dom;return 1===arguments.length?this.params[e]:(this.params[e]=-1<["min","max","value"].indexOf(e)?x(t):t,"showOn"===e&&this._addSwitcherEvents(t),n&&("theme"===e?this.setMod(n,"theme",t):"daysAfterMonths"===e&&(t?this.setMod(n,"days-after-months"):this.delMod(n,"days-after-months")),"position"===e&&this.isOpened()&&this._position(t),{min:!0,max:!0,locale:!0}[e]&&this._rebuild()),this)}},{key:"destroy",value:function(){this._isInited&&(delete this._events,this.close(),this._destroyExtensions(),document.body.removeChild(this._dom),this.params=null,this._dom=null,this._isInited=null)}},{key:"_init",value:function(){if(!this._isInited){this._isInited=!0;var e=this.setting("id"),t=document.createElement("div");t.className=this._name,e&&(t.id=e),this._dom=t,this.setMod(t,"theme",this.setting("theme")),this.setting("daysAfterMonths")&&this.setMod(t,"days-after-months"),this._rebuild(),document.body.appendChild(t)}}},{key:"_position",value:function(e){var t=d((e||"").split(" "),2),n=t[0],i=t[1],o=this.setting("switcher"),a={left:n,top:i};o&&(g(a.left)||g(a.top))&&(a=function(a,r,s){var l=g(a.left),u=g(a.top),h=-1,c=0;v.forEach(function(e,t){var n=e[0],i=e[1];if(l&&u||l&&i===a.top||u&&n===a.left){var o=_(b(a,r,s),r);h<o&&(h=o,c=t)}});var e=d(v[c],2);return{left:e[0],top:e[1]}}(a,this._dom,o)),m(this._dom,b(a,this._dom,o))}},{key:"_update",value:function(){this._init(),this._position(this.setting("position"))}},{key:"_findDayByDate",value:function(e){if(e.year!==this._currentDate.year)return null;var t=this.findElemAll("days-month")[e.month];return t&&this.findElemAllContext(t,"day")[e.day-1]||null}},{key:"_onresize",value:function(){this._update()}},{key:"_onscroll",value:function(){this._update()}},{key:"_rebuild",value:function(){var e=this.isOpened();e&&this._delOpenedEvents(),this._dom.innerHTML=this.template.get("main"),e&&(this._openedEvents(),this._monthSelector(this._currentDate.month,!1),this._yearSelector(this._currentDate.year,!1))}},{key:"_rebuildDays",value:function(){this.findElem("days-container").innerHTML=this.template.get("days"),this._monthSelector(this._currentDate.month,!1)}},{key:"_intoContainer",value:function(e){for(var t=e;t;){if(t===this._dom)return!0;t=t.parentNode}return!1}},{key:"_openedEvents",value:function(){var r=this;this.domEvent.on(document,"click",function(e){!e.button&&r.setting("autocloseable")&&(e.target===r.setting("switcher")||r._intoContainer(e.target)||r.close())},"open"),this.domEvent.on(window,"resize",function(){r._onresize()},"open").on(document,"scroll",function(){r._onscroll()},"open").on(document,"keypress",function(e){var t=r._currentDate;switch(e.keyCode){case S:r.close();break;case O:e.ctrlKey||e.altKey?r._monthSelector(t.month+1,!0):r._yearSelector(t.year+1,!0),e.preventDefault();break;case A:e.ctrlKey||e.altKey?r._monthSelector(t.month-1,!0):r._yearSelector(t.year-1,!0),e.preventDefault()}},"open").on(this._dom,"click",function(e){e.button||r.tooltip.hide()},"open");var s=this.findElem("days"),e=this.findElem("months"),t=this.findElem("years");this._onwheelmonths=function(e){var t=r._getDeltaY(e);t&&(r._monthSelector(r._currentDate.month+t,!0),e.preventDefault())},this._onwheelyears=function(e){var t=r._getDeltaY(e);t&&(r._yearSelector(r._currentDate.year+t,!0),e.preventDefault())},this.domEvent.on(s,"wheel",this._onwheelmonths,"open").on(e,"wheel",this._onwheelmonths,"open").on(t,"wheel",this._onwheelyears,"open"),this.domEvent.on(e,"click",function(e){e.button||r.hasElem(e.target,"month")&&r._monthSelector(+e.target.dataset.month,!0)},"open"),this.domEvent.on(t,"click",function(e){if(!e.button){var t=e.target.dataset.year;t&&r._yearSelector(+t,!0)}},"open"),this.domEvent.on(s,"mouseover",function(e){var t=e.target,n=+t.dataset.day,i=+t.dataset.month,o=+r._currentDate.year;r.hasElem(t,"day")&&r.hasMod(t,"has-title")&&r.tooltip.show(t,r.title.get(M(o,i,n)))},"open"),this.domEvent.on(s,"mouseout",function(e){r.hasElem(e.target,"day")&&r.tooltip.hide()},"open"),this.domEvent.on(s,"click",function(e){if(!e.button){var t=r._currentDate,n=e.target,i=n.dataset.day,o=n.dataset.month;if(i){if(r.hasMod(n,"minmax"))return;if(!r.hasMod(n,"selected")){t.day=+i,t.month=+o;var a=s.querySelector("."+r.e("day","selected"));a&&r.delMod(a,"selected"),r.setMod(n,"selected"),r.trigger("select",{day:t.day,month:t.month,year:t.year}),r.setting("closeAfterSelection")&&r.close()}}}},"open")}},{key:"_getDeltaY",value:function(e){return 1<=e.deltaY?1:e.deltaY<0?-1:0}},{key:"_monthSelector",value:function(e,t){var n=this;e<0?e=0:11<e&&(e=11),this._currentDate.month=e;var i=this.findElem("months"),o=this.findElem("month").offsetHeight,a=this.findElemAll("days-month")[e],r=this.findElem("month-selector"),s=this.findElem("days-container"),l=this.findElem("days");t||(this.setMod(l,"noanim"),this.setMod(i,"noanim"));var u=Math.floor(this._currentDate.month*o-o/2);u<=0&&(u=1),u+r.offsetHeight>=i.offsetHeight&&(u=i.offsetHeight-r.offsetHeight-1),y(r,u);var h=-Math.floor(a.offsetTop-l.offsetHeight/2+a.offsetHeight/2);0<h&&(h=0);var c=l.offsetHeight-s.offsetHeight;h<c&&(h=c),y(s,h),this._colorizeMonths(e),t||this.timeout.set(function(){n.delMod(l,"noanim"),n.delMod(i,"noanim")},0,"anim")}},{key:"_yearSelector",value:function(e,t){var n=this,i=this.params.startYear,o=this.params.endYear,a=this._currentDate.year;e<i?e=i:o<e&&(e=o),this._currentDate.year=e;var r=this.findElem("years"),s=this.findElem("years-container"),l=this.findElem("year").offsetHeight,u=this.findElem("year-selector");t||this.setMod(r,"noanim");var h=Math.floor((this._currentDate.year-i)*l),c=-Math.floor((this._currentDate.year-i)*l-r.offsetHeight/2);0<c&&(c=0),c<r.offsetHeight-s.offsetHeight&&(c=r.offsetHeight-s.offsetHeight);var d=0;r.offsetHeight>=s.offsetHeight&&((o-i+1)%2&&(d=l),c=Math.floor((r.offsetHeight-s.offsetHeight-d)/2)),e!==a&&this._rebuildDays(e),y(u,h),y(s,c),this._colorizeYears(e),t||this.timeout.set(function(){n.delMod(r,"noanim")},0,"anim")}},{key:"_decolorize",value:function(e){for(var t=0;t<this.setting("maxColor");t++)for(var n=this.findElemAll(e,"color",t),i=0,o=n.length;i<o;i++)this.delMod(n[i],"color",t)}},{key:"_colorizeMonths",value:function(e){var t=this.findElemAll("month");this._decolorize("month"),this.setMod(t[e],"color","0"),0<=e-1&&this.setMod(t[e-1],"color","0"),e+1<=11&&this.setMod(t[e+1],"color","0");for(var n=1,i=e-2;0<=i&&n<this.setting("maxColor");i--,n++)this.setMod(t[i],"color",n);n=1;for(var o=e+2;o<=11&&n<this.setting("maxColor");o++,n++)this.setMod(t[o],"color",n)}},{key:"_colorizeYears",value:function(e){var t=this.findElemAll("year"),n=this.setting("startYear");this._decolorize("year"),this.setMod(t[e-n],"color","0");for(var i=1,o=e-1;n<=o&&i<this.setting("maxColor");o--,i++)this.setMod(t[o-n],"color",i);for(var a=e+(i=1);a<=this.setting("_endYear")&&i<this.setting("maxColor");a++,i++)this.setMod(t[a-n],"color",i)}},{key:"_delOpenedEvents",value:function(){this.domEvent.offAll("open")}},{key:"_prepareYears",value:function(e){var t,n,i,o=D();return u(e)&&(t=e.trim().split(/[:,; ]/),n=parseInt(t[0],10),i=parseInt(t[1],10),isNaN(n)||isNaN(i)||(Math.abs(n)<1e3&&(n=o.year+n),Math.abs(i)<1e3&&(i=o.year+i))),{start:n||o.year-11,end:i||o.year+1}}},{key:"_updateSelection",value:function(){var e=this.findElem("day","selected");if(e&&this.delMod(e,"selected"),this._currentDate.year===this._val.year){var t=this.findElemAll("days-month");if(t&&t[this._val.month]){var n=this.findElemAllContext(t[this._val.month],"day"),i=this._val.day-1;n&&n[i]&&this.setMod(n[i],"selected")}}}},{key:"_addSwitcherEvents",value:function(e){var t=this,n=this.setting("switcher"),i=Array.isArray(e)?e:[e||"click"],o=["input","textarea"],a=["focus","mouseover"];if(this.domEvent.offAll("switcher"),-1===i.indexOf("none")&&n){var r=n.tagName.toLowerCase();i.forEach(function(e){t.domEvent.on(n,e,function(){-1!==o.indexOf(r)||-1!==a.indexOf(e)?t.open():t.toggle()},"switcher")})}}},{key:"_getSwitcherText",value:function(){var e=this._currentDate,t=this.text("months"),n=this.text("caseMonths");return e.day+" "+(n||t)[e.month]+" "+e.year}},{key:"_updateSwitcher",value:function(){var e=this.setting("switcher"),t=this._getSwitcherText();if(e){var n=e.tagName.toLowerCase();"input"===n||"textarea"===n?e.value=t:e.innerHTML=t}}}],[{key:"extend",value:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}}]),o}();H.version="0.10.0";var L={};H.addLocale=function(e,t){L[e]=t},H.getLocales=function(){return Object.keys(L)},H.prototype.text=function(e){return L[this.setting("locale")][e]};var z={};H.addHolidays=function(e,t){z[e]=t},H.prototype.getHoliday=function(e,t,n){var i=this.params.locale;return z[i]&&z[i][n]?z[i][n][e+"-"+(t+1)]:void 0};var T=function(){function e(){a(this,e)}return t(e,[{key:"init",value:function(){this._buffer=[]}},{key:"on",value:function(e,t,n,i){return e&&t&&n&&(e.addEventListener(t,n,!1),this._buffer.push({elem:e,type:t,callback:n,ns:i})),this}},{key:"off",value:function(e,t,n,i){for(var o=0;o<this._buffer.length;o++){var a=this._buffer[o];a&&a.elem===e&&a.callback===n&&a.type===t&&a.ns===i&&(e.removeEventListener(t,n,!1),this._buffer.splice(o,1),o--)}return this}},{key:"offAll",value:function(e){for(var t=0;t<this._buffer.length;t++){var n=this._buffer[t];e?e===n.ns&&(n.elem.removeEventListener(n.type,n.callback,!1),this._buffer.splice(t,1),t--):n.elem.removeEventListener(n.type,n.callback,!1)}return e||(this._buffer=[]),this}},{key:"destroy",value:function(){this.offAll(),delete this._buffer}}]),e}(),j=Array.isArray,W=Object.prototype.toString,Y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},P=/[&<>"'/]/g,I={noClosingTag:["img","input","br","embed","source","link","meta","area","command","base","col","param","wbr","hr","keygen"],ignoredKeys:["b","e","m","c","t","cl","class"],isPlainObj:function(e){return"[object Object]"===W.call(e)},build:function(e){if(null==e)return"";var t=[];if(this.isPlainObj(e))return this.tag(e);if(j(e)){for(var n=0,i=e.length;n<i;n++)t.push(this.build(e[n]));return t.join("")}return""+e},tag:function(e){var t=e.t||"div",n="<"+t+this.attrs(e);return-1!==this.noClosingTag.indexOf(t)?n+"/>":(n+=">",e.c&&(n+=this.build(e.c)),n+="</"+t+">")},attrs:function(e){var t,n,i=e.b,o=e.e,a=e.m,r=[],s=[];if(i||o){if(i=i||this._currentBlock,o?r.push(this.elem(i,o)):r.push(this.block(i)),this.isPlainObj(a)){for(n in a)a.hasOwnProperty(n)&&r.push(this.elem(i,o,n,a[n]));r.sort();for(var l=0,u=r.length;l<u;l++)r[l]!==r[l-1]&&s.push(r[l])}else s=r;t=this.attr("class",s),this._currentBlock=i}else t=(s=e.cl||e.class)?this.attr("class",s):"";for(n in e)e.hasOwnProperty(n)&&-1===this.ignoredKeys.indexOf(n)&&(t+=this.attr(n,e[n]));return t},attr:function(e,t){return null==t||!1===t?"":" "+e+'="'+function(e){return e.replace(P,function(e){return Y[e]})}(j(t)?t.join(" "):""+t)+'"'},block:function(e,t,n){return e+this.mod(t,n)},elem:function(e,t,n,i){return e+(t?"__"+t:"")+this.mod(n,i)},mod:function(e,t){return!1===t||null==t?"":"_"+e+(""===t||!0===t?"":"_"+t)},reset:function(){return this._currentBlock="",this}};
/*!
   * jstohtml
   * © 2018 Denis Seleznev
   * License: MIT
   *
   * https://github.com/hcodes/jstohtml/
  */function F(e){return I.reset().build(e)}var J=function(){function e(){a(this,e)}return t(e,[{key:"get",value:function(e){return F(this[e]())}},{key:"days",value:function(){for(var e=[],t=0;t<=11;t++)e.push(this.month(t,this.parent._currentDate.year));return e}},{key:"dayNames",value:function(){for(var e=this.parent.text("firstWeekday")||0,t={first:e,last:e?e-1:6},n=e,i=0;i<7;i++)t[n]=i,6<++n&&(n=0);return t}},{key:"month",value:function(e,t){for(var n=new Date(t,e,1,12,0,0,0),i=this.parent,o={weekday:n.getDay(),min:i.setting("min"),max:i.setting("max"),dayNames:this.dayNames()},a=this._getTs(o.min),r=this._getTs(o.max),s=this._todayAt12(),l=this._monthFirstRow(o,e,t),u=this._daysMonth(o,e,t,l),h=1;n.getMonth()===e;n.setDate(++h)){var c="",d=+n,f={},m=n.getDay(),y=i.getHoliday(h,e,t);0===m||6===m?f.holiday=!0:f.workday=!0,0===y?f.nonholiday=!0:1===y&&(f.highday=!0),this._isSelected(i._val,h,e,t)&&(f.selected=!0),s===d&&(f.now=!0,c=i.text("today")),(a&&d<a||r&&r<d)&&(f.minmax=!0);var v=i.title.get(M(t,e,h));v&&(f["has-title"]=!0,f["title-color"]=v.color||"default"),m===o.dayNames.first&&(l={t:"tr",c:[]},u.c[1].c.push(l)),l.c.push({t:"td",e:"day",m:f,title:c,"data-month":e,"data-day":h,c:h})}return u}},{key:"_todayAt12",value:function(){var e=new Date;return e.setHours(12,0,0,0),e.getTime()}},{key:"_monthFirstRow",value:function(e,t,n){var i=e.dayNames[e.weekday];return{t:"tr",c:[e.weekday!==e.dayNames.first?{t:"td",colspan:i,e:"empty",c:i<3?"":this._getTitleMonth(e.min,e.max,t,n)}:""]}}},{key:"_daysMonth",value:function(e,t,n,i){var o=e.dayNames[e.weekday];return{b:this.parent._name,e:"days-month",c:[o<3?this._getTitleMonth(e.min,e.max,t,n):"",{t:"table",e:"days-table",c:[i]}]}}},{key:"years",value:function(){for(var e=this.parent.params,t=[{b:this.parent._name,e:"year-selector",c:{e:"year-selector-i"}}],n=e.startYear;n<=e.endYear;n++)t.push({b:this.parent._name,e:"year","data-year":n,c:n});return t}},{key:"months",value:function(){var n=this,i=[{b:this.parent._name,e:"month-selector",c:{e:"month-selector-i"}}];return this.parent.text("months").forEach(function(e,t){i.push({b:n.parent._name,e:"month","data-month":t,c:e})}),i}},{key:"main",value:function(){var e=this.parent,i=e.text("dayNames")||[],o=[],a=e.text("firstWeekday")||0;return e.text("shortDayNames").forEach(function(e,t,n){o.push({e:"short-daynames-cell",m:{n:a},title:i[a]||n[a],c:n[a]}),6<++a&&(a=0)},this),[{b:this.parent._name,e:"container",c:[{e:"days-i",c:[{b:this.parent._name,e:"short-daynames",c:o},{e:"days",c:{e:"days-container",c:this.days()}}]},{e:"months",c:this.months()},{e:"years",c:{e:"years-container",c:this.years()}}]}]}},{key:"_isSelected",value:function(e,t,n,i){return t===e.day&&n===e.month&&i===e.year}},{key:"_getTitleMonth",value:function(e,t,n,i){function o(e){return parseInt(""+e.year+k(e.month),10)}var a=o(e),r=o(t),s={},l=parseInt(""+i+k(n),10);return(a&&l<a||r&&r<l)&&(s.minmax=!0),{e:"days-title-month",m:s,c:this.parent.text("months")[n]}}},{key:"_getTs",value:function(e){return e.year?new Date(e.year,e.month,e.day,12,0,0,0).getTime():null}}]),e}(),B=function(){function e(){a(this,e)}return t(e,[{key:"init",value:function(){this._buffer=[]}},{key:"set",value:function(e,t,n){var i=this,o=setTimeout(function(){e(),i.clear(o)},t);return this._buffer.push({id:o,ns:n}),o}},{key:"clear",value:function(n){var i=-1;return this._buffer&&(this._buffer.some(function(e,t){return e.id===n&&(i=t,!0)}),0<=i&&(clearTimeout(this._buffer[i].id),this._buffer.splice(i,1))),this}},{key:"clearAll",value:function(t){var e=this._buffer,n=[],i=Array.isArray(t)?t:[t];return e.forEach(function(e){t?-1!==i.indexOf(e.ns)?clearTimeout(e.id):n.push(e):clearTimeout(e.id)}),this._buffer=t?n:[],this}},{key:"destroy",value:function(){this.clearAll(),delete this._buffer}}]),e}(),q=function(){function e(){a(this,e)}return t(e,[{key:"init",value:function(e){this._title={},this.set(e.title)}},{key:"get",value:function(e){var t=E(e);return t?this._title[t]:null}},{key:"set",value:function(e){var t=this;Array.isArray(e)?e.forEach(function(e){return t._set(e)}):function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e)&&this._set(e)}},{key:"_set",value:function(e){var t=E(e.date),n=this.parent;if(t&&(this._title[t]={text:e.text,color:e.color},n._isInited)){var i=n._findDayByDate(x(e.date));i&&n.setMod(i,"has-title").setMod(i,"title-color",e.color)}}},{key:"remove",value:function(e){var t=this;Array.isArray(e)?e.forEach(function(e){return t._remove(e)}):this._remove(e)}},{key:"_remove",value:function(e){var t=this.parent,n=E(e);if(n&&(delete this._title[n],t._isInited)){var i=t._findDayByDate(x(e));i&&t.delMod(i,"has-title").delMod(i,"title-color")}}},{key:"removeAll",value:function(){var e=this.parent;if(this._title={},e._isInited){var t=e.findElemAll("day","has-title");if(t)for(var n=0;n<t.length;n++)e.delMod(t[n],"has-title").delMod(t[n],"title-color")}}},{key:"destroy",value:function(){delete this._title}}]),e}(),K=function(){function e(){a(this,e)}return t(e,[{key:"show",value:function(e,t){this._create(),t=t||{};var n=this.parent,i=this._dom;n.setMod(i,"theme",n.setting("theme")).setMod(i,"visible").setMod(i,"color",t.color||"default"),n.findElemContext(i,"tooltip-text").innerHTML=F({b:this.parent._name,e:"tooltip-row",c:t.text});var o=f(e);m(i,{left:o.left-(i.offsetWidth-e.offsetWidth)/2,top:o.top-i.offsetHeight-5}),this._isOpened=!0}},{key:"hide",value:function(){this._isOpened&&(this.parent.delMod(this._dom,"visible"),this._isOpened=!1)}},{key:"_create",value:function(){if(!this._dom){var e=document.createElement("div"),t=this.parent,n=t._name;e.classList.add(t.e("tooltip")),e.innerHTML=F([{b:n,e:"tooltip-text"},{b:n,e:"tooltip-tail"}]),document.body.appendChild(e),this._dom=e}}},{key:"destroy",value:function(){this._dom&&(this.hide(),document.body.removeChild(this._dom),delete this._dom)}}]),e}(),V=[];function R(e){return e.name[0].toLowerCase()+e.name.substr(1)}return H.extend(H.prototype,{_initExtensions:function(){var n=this;V.forEach(function(e){var t=new e;((t.parent=n)[R(e)]=t).init&&t.init(n.params,n._dom)})},_destroyExtensions:function(){var n=this;V.forEach(function(e){var t=R(e);n[t].destroy&&n[t].destroy(),delete n[t]},this)}}),H.addExtension=function(e){Array.isArray(e)?V=V.concat(e):V.push(e)},H.addExtension([T,J,B,q,K]),H}),Calendula.addLocale("be",{months:["студзень","люты","сакавік","красавік","май","чэрвень","ліпень","жнівень","верасень","кастрычнік","лістапад","снежань"],caseMonths:["студзеня","лютага","сакавіка","красавіка","траўня","траўня","ліпеня","жніўня","верасня","кастрычніка","лістапада","снежня"],shortDayNames:["Н","П","А","С","Ч","П","С"],dayNames:["Нядзеля","Панядзелак","Аўторак","Серада","Чацьвер","Пятніца","Субота"],today:"Сення",firstWeekday:1}),Calendula.addLocale("de",{months:["Januar","Februar","Marz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortDayNames:["So","Mo","Di","Mi","Do","Fr","Sa"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],today:"Heute",firstWeekday:1}),Calendula.addLocale("en",{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],today:"Today",firstWeekday:0}),Calendula.addLocale("es",{months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortDayNames:["Do","Lu","Ma","Mi","Ju","Vi","S?"],dayNames:["Domingo","Lunes","Martes","Mi?rcoles","Jueves","Viernes","S?bado"],today:"Hoy",firstWeekday:1}),Calendula.addLocale("fr",{months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],shortDayNames:["Di","Lu","Ma","Me","Je","Ve","Sa"],dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],today:"Aujourd’hui",firstWeekday:1}),Calendula.addLocale("it",{months:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],shortDayNames:["Do","Lu","Ma","Me","Gi","Ve","Sa"],dayNames:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"],today:"Oggi",firstWeekday:1}),Calendula.addLocale("pl",{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],caseMonths:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],shortDayNames:["N","P","W","Ś","C","P","S"],dayNames:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],today:"Dziś",firstWeekday:1}),Calendula.addLocale("ru",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],caseMonths:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],shortDayNames:["В","П","В","С","Ч","П","С"],dayNames:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],today:"Сегодня",firstWeekday:1}),Calendula.addLocale("tr",{months:["ocak","şubat","mart","nisan","mayıs","haziran","temmuz","ağustos","eylül","ekim","kasım","aralık"],shortDayNames:["Pz","Pt","Sa","Ça","Pe","Cu","Ct"],dayNames:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],today:"Bugün",firstWeekday:1}),Calendula.addLocale("uk",{months:["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],caseMonths:["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],shortDayNames:["Н","П","В","С","Ч","П","С"],dayNames:["Неділя","Понеділок","Вівторок","Середа","Четвер","П’ятниця","Субота"],today:"Сьогодні",firstWeekday:1}),Calendula.addHolidays("ru",{2012:{"1-1":1,"2-1":1,"3-1":1,"4-1":1,"5-1":1,"6-1":1,"7-1":1,"9-1":1,"23-2":1,"8-3":1,"9-3":1,"11-3":0,"28-4":0,"30-4":1,"1-5":1,"5-5":0,"7-5":1,"8-5":1,"9-5":1,"12-5":0,"9-6":0,"11-6":1,"12-6":1,"4-11":1,"5-11":1,"29-12":0,"31-12":1},2013:{"1-1":1,"2-1":1,"3-1":1,"4-1":1,"5-1":1,"6-1":1,"7-1":1,"8-1":1,"23-2":1,"8-3":1,"1-5":1,"2-5":1,"3-5":1,"9-5":1,"10-5":1,"12-6":1,"4-11":1},2014:{"1-1":1,"2-1":1,"3-1":1,"4-1":1,"5-1":1,"6-1":1,"7-1":1,"8-1":1,"23-2":1,"8-3":1,"10-3":1,"1-5":1,"2-5":1,"9-5":1,"12-6":1,"13-6":1,"3-11":1,"4-11":1},2015:{"1-1":1,"2-1":1,"3-1":1,"4-1":1,"5-1":1,"6-1":1,"7-1":1,"8-1":1,"23-2":1,"8-3":1,"1-5":1,"9-5":1,"12-6":1,"4-11":1},2016:{"1-1":1,"2-1":1,"3-1":1,"4-1":1,"5-1":1,"6-1":1,"7-1":1,"8-1":1,"20-2":0,"22-2":1,"23-2":1,"7-3":1,"8-3":1,"1-5":1,"2-5":1,"3-5":1,"9-5":1,"12-6":1,"13-6":1,"4-11":1},2017:{"1-1":1,"2-1":1,"3-1":1,"4-1":1,"5-1":1,"6-1":1,"7-1":1,"8-1":1,"23-2":1,"24-2":1,"8-3":1,"1-5":1,"8-5":1,"9-5":1,"12-6":1,"4-11":1,"6-11":1},2018:{"1-1":1,"2-1":1,"3-1":1,"4-1":1,"5-1":1,"6-1":1,"7-1":1,"8-1":1,"23-2":1,"8-3":1,"1-5":1,"9-5":1,"12-6":1,"4-11":1}}),Calendula.addHolidays("tr",{2012:{"1-1":1,"23-4":1,"1-5":1,"19-5":1,"30-8":1,"29-10":1},2013:{"1-1":1,"23-4":1,"1-5":1,"19-5":1,"7-8":1,"8-8":1,"9-8":1,"10-8":1,"30-8":1,"14-10":1,"15-10":1,"16-10":1,"17-10":1,"18-10":1,"28-10":1,"29-10":1},2014:{"1-1":1,"23-4":1,"1-5":1,"19-5":1,"27-7":1,"28-7":1,"29-7":1,"30-7":1,"30-8":1,"3-10":1,"4-10":1,"5-10":1,"6-10":1,"28-10":1,"29-10":1},2015:{"1-1":1,"23-4":1,"1-5":1,"19-5":1,"30-8":1,"29-10":1},2016:{"1-1":1,"23-4":1,"1-5":1,"19-5":1,"4-7":1,"5-7":1,"6-7":1,"7-7":1,"30-8":1,"12-9":1,"13-9":1,"14-9":1,"15-9":1,"28-10":1,"29-10":1},2017:{"1-1":1,"23-4":1,"1-5":1,"19-5":1,"24-6":1,"25-6":1,"26-6":1,"27-6":1,"30-8":1,"31-8":1,"1-9":1,"2-9":1,"3-9":1,"4-9":1,"28-10":1,"29-10":1},2018:{"1-1":1,"23-4":1,"1-5":1,"19-5":1,"30-8":1,"29-10":1}}),Calendula.addHolidays("uk",{2012:{"1-1":1,"2-1":1,"6-1":1,"7-1":1,"3-3":0,"8-3":1,"9-3":1,"16-4":1,"28-4":0,"30-4":1,"1-5":1,"2-5":1,"9-5":1,"4-6":1,"28-6":1,"29-6":1,"7-7":0,"24-8":1},2013:{"1-1":1,"7-1":1,"8-3":1,"1-5":1,"2-5":1,"3-5":1,"5-5":1,"6-5":1,"9-5":1,"10-5":1,"18-5":0,"1-6":0,"23-6":1,"24-6":1,"28-6":1,"24-8":1,"26-8":1},2014:{"1-1":1,"2-1":1,"3-1":1,"6-1":1,"7-1":1,"11-1":0,"25-1":0,"8-2":0,"8-3":1,"10-3":1,"20-4":1,"21-4":1,"1-5":1,"2-5":1,"9-5":1,"8-6":1,"9-6":1,"28-6":1,"30-6":1,"24-8":1,"25-8":1},2015:{"1-1":1,"7-1":1,"8-3":1,"1-5":1,"2-5":1,"9-5":1,"28-6":1,"24-8":1},2016:{"1-1":1,"7-1":1,"8-1":1,"16-1":0,"7-3":1,"8-3":1,"12-3":0,"1-5":1,"2-5":1,"3-5":1,"9-5":1,"19-6":1,"20-6":1,"27-6":1,"28-6":1,"2-7":0,"24-8":1,"14-10":1},2017:{"1-1":1,"2-1":1,"7-1":1,"9-1":1,"8-3":1,"16-4":1,"17-4":1,"1-5":1,"2-5":1,"8-5":1,"9-5":1,"13-6":0,"4-6":1,"5-6":1,"28-6":1,"24-8":1,"14-10":1,"16-10":1},2018:{"1-1":1,"7-1":1,"8-3":1,"1-5":1,"2-5":1,"9-5":1,"28-6":1,"24-8":1,"14-10":1}});